/*
 * Transformation Matrix JS v1.5 (c) Epistemex 2014
 * www.epistemex.com
 * License: MIT, this header required.
*/
function Matrix(a){this.a=1;this.b=0;this.c=0;this.d=1;this.e=0;this.f=0;this.context=a||null;if(a){a.setTransform(1,0,0,1,0,0)}}Matrix.prototype={flipX:function(){this.transform(-1,0,0,1,0,0);return this},flipY:function(){this.transform(1,0,0,-1,0,0);return this},reset:function(){this.a=this.d=1;this.b=this.c=this.e=this.f=0;this._setCtx();return this},rotate:function(a){var b=Math.cos(a),c=Math.sin(a);this.transform(b,c,-c,b,0,0);return this},rotateDeg:function(a){this.rotate(a*0.0174532925199433);return this},scale:function(a,b){this.transform(a,0,0,b,0,0);return this},scaleX:function(a){this.transform(a,0,0,1,0,0);return this},scaleY:function(a){this.transform(1,0,0,a,0,0);return this},skew:function(a,b){this.transform(1,b,a,1,0,0);return this},skewX:function(a){this.transform(1,0,a,1,0,0);return this},skewY:function(a){this.transform(1,a,0,1,0,0);return this},setTransform:function(g,h,i,j,k,l){this.a=g;this.b=h;this.c=i;this.d=j;this.e=k;this.f=l;this._setCtx();return this},translate:function(a,b){this.transform(1,0,0,1,a,b);return this},translateX:function(a){this.transform(1,0,0,1,a,0);return this},translateY:function(a){this.transform(1,0,0,1,0,a);return this},transform:function(b,d,f,h,j,l){var a=this.a,c=this.b,e=this.c,g=this.d,i=this.e,k=this.f;this.a=a*b+e*d;this.b=c*b+g*d;this.c=a*f+e*h;this.d=c*f+g*h;this.e=a*j+e*l+i;this.f=c*j+g*l+k;this._setCtx();return this},getInverse:function(){var g=this.a,h=this.b,i=this.c,j=this.d,l=this.e,n=this.f,o=new Matrix(),k=(g*j-h*i);o.a=j/k;o.b=-h/k;o.c=-i/k;o.d=g/k;o.e=(i*n-j*l)/k;o.f=-(g*n-h*l)/k;return o},interpolate:function(b,c){var a=new Matrix();a.a=this.a+(b.a-this.a)*c;a.b=this.b+(b.b-this.b)*c;a.c=this.c+(b.c-this.c)*c;a.d=this.d+(b.d-this.d)*c;a.e=this.e+(b.e-this.e)*c;a.f=this.f+(b.f-this.f)*c;return a},applyToPoint:function(a,b){return{x:a*this.a+b*this.c+this.e,y:a*this.b+b*this.d+this.f}},applyToArray:function(e){var a=0,d,b,c=[];if(typeof e[0]==="number"){b=e.length;while(a<b){d=this.applyToPoint(e[a++],e[a++]);c.push(d.x,d.y)}}else{for(;d=e[a];a++){c.push(this.applyToPoint(d.x,d.y))}}return c},applyToTypedArray:function(e){var a=0,d,b=e.length,c=new Float32Array(b);while(a<b){d=this.applyToPoint(e[a],e[a+1]);c[a++]=d.x;c[a++]=d.y}return c},applyToContext:function(a){a.setTransform(this.a,this.b,this.c,this.d,this.e,this.f);return this},isIdentity:function(){return(this._isEqual(this.a,1)&&this._isEqual(this.b,0)&&this._isEqual(this.c,0)&&this._isEqual(this.d,1)&&this._isEqual(this.e,0)&&this._isEqual(this.f,0))},isEqual:function(a){return(this._isEqual(this.a,a.a)&&this._isEqual(this.b,a.b)&&this._isEqual(this.c,a.c)&&this._isEqual(this.d,a.d)&&this._isEqual(this.e,a.e)&&this._isEqual(this.f,a.f))},_isEqual:function(a,b){return Math.abs(a-b)<1e-14},_setCtx:function(){if(this.context){this.context.setTransform(this.a,this.b,this.c,this.d,this.e,this.f)}}};